---
description: >-
  Detta kapitel beskriver systemets övergripande arkitektur och hur de olika
  delarna samverkar för att skapa en skalbar, säker och underhållbar lösning.
---

# 3. Projektarkitektur

### 3.1 Övergripande arkitektur

BetteRFlow är uppbyggt enligt en **lagerindelad arkitektur** där frontend, backend och datalager är tydligt separerade. Denna uppdelning gör systemet mer överskådligt, förenklar felsökning och möjliggör vidareutveckling utan att påverka hela applikationen.

Arkitekturen kan sammanfattas i tre huvudlager:

* **Presentationslager (Frontend)** – Blazor Server
* **Applikationslager (Backend)** – ASP.NET Core Web API
* **Datalager** – SQLite (lokalt) och PostgreSQL (produktion)

Kommunikationen mellan frontend och backend sker via HTTP-anrop mot API:ets endpoints.

### 3.2 Frontend-arkitektur

Frontend är implementerad som en **Blazor Server-applikation**, där användargränssnittet renderas på serversidan och uppdateras dynamiskt via SignalR-anslutning till klienten.

Frontend ansvarar för:

* användarinteraktion
* formulärinmatning och validering
* navigation mellan sidor
* presentation av data baserat på användarroll

Frontend innehåller ingen affärslogik eller direkt databasåtkomst. All känslig logik och datamanipulation sker i backend, vilket minskar risken för manipulation från klienten.

### .3 Backend-arkitektur

Backe3nd är byggd som ett fristående **ASP.NET Core Web API** och fungerar som systemets centrala nav. API:et hanterar:

* autentisering och inloggning
* rollbaserad åtkomstkontroll
* affärslogik
* datavalidering
* kommunikation med databasen

API:et är uppdelat i controllers med tydliga ansvarsområden, exempelvis för användare, formulär, köpflöden och administrativ funktionalitet. Detta bidrar till en modulär struktur där varje del kan utvecklas och testas separat.

### 3.4 Databasarkitektur och relationer

Databasen är relationsbaserad och designad för att säkerställa spårbarhet och dataintegritet. Centrala relationer i systemet inkluderar:

* En BRF kan ha flera inskickade formulär
* Ett formulär hör alltid till en specifik BRF
* Ett köp kopplas till både mäklare och formulär
* Avvikelser kopplas till både BRF och formulär
* En användare har exakt en roll

Denna struktur gör det möjligt att följa informationsflödet genom systemet och säkerställa att data används på ett kontrollerat sätt.

### 3.5 Rollbaserad arkitektur och åtkomst

Systemet använder en **rollbaserad arkitektur** där användarens roll styr både tillgängliga funktioner och navigation i applikationen.

* BRF-användare har endast åtkomst till sina egna formulär
* Mäklare kan söka och köpa information
* Administratörer har tillgång till administrativa vyer och granskningsfunktioner

Rollkontroller sker primärt i backend, vilket innebär att frontend inte kan manipulera behörigheter genom exempelvis ändrad klientkod.

***

### 3.6 Kommunikation mellan komponenter

Kommunikationen mellan frontend och backend sker via **REST-baserade HTTP-anrop**. Frontend använder HttpClient för att anropa API:ets endpoints med relativa URL:er, vilket möjliggör flexibel konfiguration mellan lokal utveckling och produktion.

All kommunikation är strukturerad och baserad på DTO-objekt, vilket skapar en tydlig kontraktyta mellan frontend och backend.

### 3.7 Infrastruktur- och körmiljöarkitektur

Applikationen är anpassad för att köras i både lokal utvecklingsmiljö och molnbaserad produktionsmiljö. Lokalt körs frontend och backend som separata projekt, medan produktion bygger på containerbaserad drift.

Genom att använda Docker skapas en konsekvent körmiljö som minskar skillnader mellan utveckling och produktion. Detta underlättar felsökning och minskar risken för miljörelaterade fel.

### 3.8 Arkitekturens fördelar

Den valda arkitekturen ger flera tydliga fördelar:

* Tydlig separation av ansvar
* Förbättrad säkerhet genom backend-baserad logik
* Möjlighet att skala frontend och backend oberoende av varandra
* Enklare testning och vidareutveckling
* God grund för framtida funktioner och integrationer
