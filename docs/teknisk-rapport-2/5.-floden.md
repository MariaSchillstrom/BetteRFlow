---
description: >-
  Detta kapitel beskriver de centrala användarflödena i systemet och hur
  information rör sig mellan olika roller och komponenter. Fokus ligger på de
  praktiska arbetsflöden som systemet är byggt för att
---

# 5. Flöden

### 5.1 Registrerings- och inloggningsflöde

Registrering och inloggning utgör grunden för all vidare användning av systemet.

#### Registrering

Endast rollerna **BRF** och **Mäklare** kan registrera sig via det publika registreringsformuläret. Vid registrering:

* valideras inmatad information
* lösenord hash-as med BCrypt
* användaren tilldelas vald roll
* kontot sparas i databasen som aktivt

Administratörer kan av säkerhetsskäl inte registreras via detta flöde.

#### Inloggning

Vid inloggning:

1. Användaren anger e-post och lösenord
2. Backend verifierar lösenordet mot lagrad hash
3. Användarens roll identifieras
4. Användaren dirigeras automatiskt till rätt vy baserat på roll

Detta säkerställer att varje användare endast får tillgång till relevant funktionalitet.



### 5.2 BRF-flöde

BRF-flödet är utformat för att förenkla insamling och uppdatering av föreningsinformation.

1. BRF-användare loggar in i systemet
2. Ett digitalt formulär fylls i med föreningsuppgifter
3. Formuläret skickas in och sparas som en ny FormSubmission
4. Systemet kopplar formuläret till rätt BRF
5. Inskickad information används som underlag för jämförelse mot befintlig grunddata

Varje formulär sparas separat, vilket möjliggör historik och spårbarhet över tid.

### 5.3 Avvikelseflöde

Avvikelseflödet är en central del av systemets innovation och kvalitetssäkring.

1. När ett formulär skickas in jämför systemet automatiskt formulärdata med befintlig grunddata
2. För varje fält som skiljer sig skapas en BrfAvvikelse (ej applicerat för orgnummer ännu)
3. Avvikelser lagras i databasen med koppling till både BRF och formulär
4. BRF markeras som att formulär har skickats in

Detta flöde möjliggör att förändringar fångas upp utan att automatiskt skriva över befintlig data.

### 5.4 Adminflöde – granskning av avvikelser

Administratörens flöde fokuserar på manuell granskning och beslut.

1. Administratören loggar in och når Admin Dashboard
2. Ogranskade avvikelser listas i en översiktsvy
3. För varje avvikelse visas:
   * vilket fält som skiljer sig
   * värde i grunddata
   * värde i formulär
4. Administratören fattar beslut:
   * godkänna → grunddata uppdateras
   * avvisa → grunddata behålls
5. Avvikelsen markeras som granskad - dock måste man i detta fallet just nu manuellt ändra Brf från inaktiv till aktiv.

Detta säkerställer att datakvalitet upprätthålls genom mänsklig kontroll.

### 5.5 Mäklare – sök- och köpflöde

Mäklarflödet är anpassat för att snabbt ge tillgång till relevant information.

1. Mäklare loggar in i systemet
2. Sökning sker efter BRF
3. Tillgänglig information visas i översikt
4. Mäklare väljer att köpa detaljerad information
5. Ett köp skapas i systemet

Köpet kopplas till både mäklare och formulär, vilket skapar tydlig spårbarhet.

### 5.6 Betalningsflöde (förenklad implementation)

För projektets nuvarande fas används ett förenklat betalningsflöde.

* Köpet markeras direkt som genomfört
* Ett transaktions-ID genereras
* Köpet sparas i databasen

Detta möjliggör demonstration av affärslogiken utan att integrera extern betaltjänst. Strukturen är dock förberedd för framtida integration med exempelvis Swish.

### 5.7 Informations- och dataflöde mellan systemets delar

Alla användarflöden följer samma grundprincip:

* frontend ansvarar för presentation och interaktion
* backend hanterar validering, logik och datalagring
* databasen används som enda sanningskälla

Denna uppdelning gör flödena tydliga, spårbara och säkra.

### 5.8 Sammanfattning av flöden

Systemets flöden är utformade för att:

* minimera manuell hantering
* säkerställa datakvalitet
* skapa tydliga ansvarsområden mellan roller
* möjliggöra framtida vidareutveckling

Flödesdesignen utgör grunden för systemets funktionalitet och affärsvärde.
