# 8. Lokal körning

#### 8.1 Förutsättningar

Följande måste vara installerat på din dator:

* **.NET 8 SDK** - [Ladda ner här](https://dotnet.microsoft.com/download/dotnet/8.0)
* **Visual Studio 2022** (rekommenderat) eller **Visual Studio Code**
* **Git** - För att klona repository

#### 8.2 Installation och körning

**Steg 1: Klona repository**

```
git clone https://github.com/MariaSchillstrom/BetteRFlow.git
cd BetteRFlow
```

**Steg 2: Återställ NuGet-paket**

```
dotnet restore
```

**Steg 3: Kör migrations (skapa databas)**

```
cd BetteRFlow.Shared
dotnet ef database update --startup-project ../BetteRFlowWebAPI
```

Detta skapar `betterflow.db` i Shared-projektet.

**Steg 4: Starta backend**

```
cd ../BetteRFlowWebAPI
dotnet run
```

Backend körs nu på: `https://localhost:7007`

**Steg 5: Starta frontend (nytt terminalfönster)**

```
cd ../BetteRFlowWebAPI
dotnet run
```



Frontend körs nu på: `https://localhost:7026`

#### 8.3 Testa applikationen

1. **Öppna frontend**: Navigera till `https://localhost:7026` i din webbläsare
2. **Testa Swagger (API-dokumentation)**: Navigera till `https://localhost:7007/swagger`
3. **Registrera en testanvändare**:
   * Gå till `/register`
   * Fyll i formuläret
   * Välj roll (BRF-medlem eller Mäklare)
   * Klicka "Registrera"
4. **Logga in**:
   * Gå till `/login`
   * Ange email och lösenord
   * Klicka "Logga in"



#### 8.4 Miljövariabler och konfiguration

**Backend (appsettings.json)**

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=betterflow.db"
  },
  "Cors": {
    "AllowedOrigins": ["https://localhost:7026"]
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}
```

**Frontend (appsettings.json)**

```json
{
  "ApiBaseUrl": "https://localhost:7007"
}
```

#### 8.5 Felsökning

**Problem: "Connection refused" när frontend försöker nå backend**

* Kontrollera att backend körs på port 7007
* Kontrollera CORS-inställningar i backend

**Problem: "Database locked" eller "Database file not found"**

* Kör migrations igen: `dotnet ef database update`
* Kontrollera att du är i rätt katalog

**Problem: "Certificate error" i webbläsare**

* Kör: `dotnet dev-certs https --trust`
* Acceptera säkerhetscertifikatet

